{% extends 'base.html.twig' %}

{% block title %}Admin{% endblock %}

{% block body %}

{% for message in app.flashes('success') %}
  <div class="flash-message flash-success">
      {{ message }}
  </div>
{% endfor %}
{% for message in app.flashes('danger') %}
  <div class="flash-message flash-danger">
      {{ message }}
  </div>
{% endfor %}

<div class="admin-header">
    <h1>Bienvenue {{user.prenom}}</h1>
</div>

<div class="admin-search-container">
    {# creation d'un tableauu pour pouvoir recuperer les parametres de la recherche #}
    {% set parameters = ['Id', 'Date', 'Chauffeur','Utilisateur'] %}
    <div class="admin-search-header">
        <h2>Rechercher une Course</h2>
    </div>
    <div class="admin-search-form">
        {% for param in parameters %}
        {# Je passe un parametre a laroute, pour eviter d'implementer 4 methodes differentes #}
        {# je recupere le parametre dans la route en minuscule#}
            <form action="{{ path('app_admin_search_course', {'parameter': param|lower}) }}" method="get">
                <label for="prameter-{{ param|lower }}"><strong>Recherch par {{ param }} </strong></label>
                <input type="text" class="input-{{ param|lower }}" name="parameter-{{ param|lower }}" >
                <button type="submit" class="btn adminSearchBtn">Valider</button>
            </form>
        {% endfor %}
    </div>
</div>

<div class="admin-buttons">
    <button id="chauffeur-btn" class="btn" onclick="toggleContainer('admin-chauffeur-container','chauffeur-btn')">Créer un Chauffeur</button>
    <button id="societe-btn" class="btn" onclick="toggleContainer('admin-societe-container','societe-btn')">Créer une Société</button>
</div>

<div id="admin-chauffeur-container" style="display: none;">
    <div id="chauffeur-form">
        <h2>Créer un Chauffeur</h2>
        {{ form_start(chauffeurForm, {'action': path('app_chauffeur_add'), 'method': 'POST', 'attr': {'enctype': 'multipart/form-data'}}) }}
        {{ form_widget(chauffeurForm._token, {'id': 'chauffeur_form'}) }}

        <div class="form-first-row">
            <div class="form-group">
                {{ form_row(chauffeurForm.nom) }}
            </div>
            <div class="form-group">
                {{ form_row(chauffeurForm.prenom) }}
            </div>
            <div class="form-group">
                <label for="emaom">Email</label>
               <input type="email" name="email" placeholder="Email">
            </div>
        </div>

        <div class="form-second-row">
            <div class="form-group">
                {{ form_row(chauffeurForm.dateNaissance) }}
            </div>
            <div class="form-group">
                {{ form_row(chauffeurForm.sexe) }}
            </div>
            <div class="form-group">
                {{ form_row(chauffeurForm.societe) }}
            </div>
        </div>

        <div class="form-third-row">
            <div class="form-group">
                {{ form_row(chauffeurForm.image) }}
            </div>
        </div>

        <div class="chauffeur-form">
            <h2>Créer un mot de passe pour chauffeur</h2>
            <div class="form-group">
                {{ form_row(chauffeurForm.password) }}
            </div>
            <div class="form-group">
                {{ form_row(chauffeurForm.passwordConfirmation) }}
            </div>
        </div>

        <div class="form-group">
            {{ form_row(chauffeurForm.valider) }}
        </div>

        {{ form_end(chauffeurForm) }}
    </div>
</div>
<div id="admin-societe-container" style="display: none;">
    <div id="societe-form">
        <h2>Créer une société</h2>
        {{ form_start(societeForm, {'action': path('app_societe_add'), 'method': 'POST', 'attr': {'enctype': 'multipart/form-data'}}) }}
        
        {{form_end(societeForm)}}
    </div> 
</div>

<script>
function toggleContainer(containerId,buttonId) {
    var container = document.getElementById(containerId);
    var button = document.getElementById(buttonId); 

    container.style.display = container.style.display === 'none' ? 'block' : 'none';// si display none alors block sinon none
    container.style.marginBottom = '90px';
    button.classList.toggle('active');  
}
const parameters = ['Id', 'Date', 'Chauffeur','Utilisateur']
const searchInputs = document.querySelectorAll('.input-id, .input-date, .input-chauffeur, .input-utilisateur');
searchInputs[0].placeholder = 'Ex #043523';
searchInputs[1].placeholder = 'Ex 2023-09-01';
searchInputs[2].placeholder = 'Nom du chauffeur';
searchInputs[3].placeholder = 'Nom d\'utilisateur';
</script>

{% endblock %}
